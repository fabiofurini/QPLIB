\documentclass[11pt]{article}
\usepackage[american]{babel}
%\usepackage{a4wide,paralist,url,xcolor,xspace}
\usepackage{a4wide,url,xcolor,xspace}
\definecolor{acblue}{rgb}{0,0,1}
\definecolor{acgreen}{rgb}{0,1,0}
\definecolor{acred}{rgb}{1,0,0}
\newcommand{\rep}[1]{{\textcolor{acblue}{#1}}}
%\newcommand{\comm}[1]{{\textcolor{acgreen}{#1}}}
\newcommand{\comm}[1]{}
\newcommand{\todo}[1]{{\textcolor{acred}{#1}}}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{booktabs}
\usepackage{multirow}

\newcommand{\eg}{e.g.,\xspace}
\newcommand{\ie}{i.e.,\xspace}

\parindent0pt
\parskip.8ex


\newcommand{\leo}[1]{{\color{red}#1}}
\newcommand{\fabio}[1]{{\color{cyan}#1}}
\newcommand{\emiliano}[1]{{\color{blue}#1}}   
\newcommand{\antonio}[1]{{\color{ForestGreen}#1}}     
\newcommand{\andrea}[1]{{\color{blue}{\bf #1}}}   

\begin{document}

\section*{QPLIB: a Library of a Quadratic Programming Instances (MPC-022017-00003)-- Answer to the Referees}

\rep{
 Following the Area Editor suggestions, we 
 performed a revision of our manuscript. We carefully took into account all the comments made by the Referees and the Associate Editor.
 The new submitted document highlights in red the text that has been
added or changed.
In the following, the comments of the Associate Editor and of the Referees are reported, together with our point-by-point replies.
}


\subsection*{Reply to the Associate Editor}

{\it
I have received two reviews for this manuscript, and while there is consensus that the library makes an important contribution, one of the reviewers in particular had significant concerns with the library and the manuscript describing it. The most significant concern, which I share, is that the paper is significantly longer than it needs to be. In particular, I did not see a great need to review the solution methods as is done in Section 2.3. Mentioning the current solvers, and which classes of problems they can solve according to your taxonomy is perhaps useful for a reader's reference. But attempting to describe the algorithms themselves is somewhat futile, as it takes significant space and yet is still an inadequate description. For that, it would be better to simply provide some references for the benefit of readers who are interested in understanding the algorithms in the solvers. 
}

\rep{We agree with the AE that the description of the solution methods goes beyond the scope of the paper. For this reason we have streamlined Section 2.3 which now contains only a quick overview of the solvers and their solution methods. 
%\leo{Togliamo la spiegazione degli algoritmi e sostituiamola con una citazione di un book-tutorial-survey-introduction.}
}

{\it
I also agree with the reviewer's concern that some of the instance classes have only a single instance in them. If I am a researcher designing a method for solving instances in that class, I will be pretty disappointed to find that QPLIB only has a single relevant test instance. 
}




\rep{
We performed an internal call for instances among the members of the committee. 
We gathered $86$ new instances (belonging to the categories less that were not well represented) and we added them to the library. We added a macro classification of the instances, based on convexity and nature of the variables.
We believe that the majority of the algorithms used in the literature falls in one of these category.
This macro classification shows that the library is now well-balanced.
We kept also the detailed classification since it allows a fine grained analysis of the instances.
%%
%\leo{Sono d'accordo, ma come/dove troviamo le istanze supplementari? Sono le categorie con  $<10$ istanze nelle tavole 4 e 5, giusto? Dire che ce ne sono parecchie. 15 categorie su 23 hanno meno di 10 istanze (il numero 10 e` magico perche' le nostre mani hanno dieci dita, ovviamente).} 
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{table}[h1]
%{
% \centering
% %\scriptsize
% \setlength{\tabcolsep}{18pt}
% \renewcommand \arraystretch{1.1}
%\begin{tabular}{llr}
%\toprule
%Variables & Convexity & \#\\
%\cmidrule(lr){1-3}
%%
% \textit{continuous}	& \textit{convex}		&  32 \\[1.2 ex]
% \textit{continuous}	& \textit{non-convex} 	&  102 \\[1.2 ex]
% \textit{discrete}	& \textit{convex}		&  31 \\[1.2 ex]
% \textit{discrete}	& \textit{non-convex}	&  288 \\[1.2 ex]
%\cmidrule(lr){1-3}
%Total		&				& 453\\
%%
%\bottomrule
%\end{tabular}
%\caption{Macro classification of the final set of instances}
%\label{tab:DDDDD}
%}
%\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\it
I recommend the authors be given a chance to revise the manuscript (and library) to address the concerns raised by the reviewers, or otherwise provide justification for comments they choose not to address in their revision. I think that if the library and manuscript can be improved along these lines, this cab be a substantial and important contribution to the computational optimization field. 
}


\rep{We would like to thank the Editor-in-Chief for having given us the possibility to perform a revision of our manuscript. In the following we present the improvements we made in accordance with the comments of the referees. }




\subsection*{Point-by-point reply to the Referee 1}

{\it
This paper presents a very thoughtfully constructed library of Quadratic Programming problems. I am not sure if there is a clear MPC policy on library
papers. I think it my merit a discussion at some time. Personally, I think libraries are very important so thoughtfully constructed ones such as this should
be encouraged and supported by MPC. However, I worry a bit about the over-
proliferation of such libraries, hence the reason for a possible discussion. Fortunately, I do not believe this is an issue with the library proposed in this
manuscript. The closest library to it I can think of is the CBLIB library I
mention bellow and the conceptual overlap is rather minimal. Furthermore, as
I believe the collection and selection of instances was very thorough and well
reasoned. Finally, I believe the brief survey and taxonomy of QP problems has
its own value beyond the library. I do have some comments bellow, but I believe
they can be easily addressed without the need for an additional detailed review.
Hence, my recommendation is the paper be accepted after a minor revision.
}

\rep{We thank the referee for his/her positive opinion on our manuscript. We hope that the new library will serve our scientific community.}

{\it
Minor Comments:
\begin{enumerate}

\item I think it would be interesting to mention the Conic library CBLIB \url{http://cblib.zib.de} and its relation to the library described in the manuscript.

\rep{We updated the manuscript by adding the suggest link.}


\item Page 7, line -4. You say that convex means that the feasible region is
convex, but in page 19 you discuss the fact that SOCP problems that have
a convex feasible region could be considered nonconvex. Hence, maybe it
is more accurate to say that what you mean is that the constraint can be
converted to $f (x) \le c$ with $f$ convex by rearranging terms.

\rep{We removed a sentence from this paragraph to address this concern and we added a paragraph on this issue.
%TODO: Leo 
%\leo{secondo me il secondo commento si riferisce a pagina 19... a pagina 7 riga -4 non trovo niente su SOCP. Pero` sono d'accordo che a pagina 19 l'ultimo paragrafo della sezione 3.1 potrebbe essere migliorato. Cosi` e` un po' criptico. Perche' non inserire un bell'esempio di una forma bilineare nonconvessa (scrivendola esplicitamente come xQx e dando esplicitamente lo spettro di Q con la parte definita negativa) inserita in un vincolo che definisce una regione convessa? E poi io direi che facciamo la scelta di mettere queste istanze come "nonconvesse" perche' dimostrare convessita` in generale e` difficile (a questo proposito, io conosco i risultati del PhD di Amir Ali Ahmadi sulla difficolta` di riconoscere la convessita` in polinomi di grado $>= 4$, ma non ho mai visto una dimostrazione di difficolta` di riconoscere la convessita` della feasible region in vincoli quadratici; spero che qualcuno dei nostri co-autori ne sia al corrente)... Il referee ricorda che riconoscere i casi di forme quadratiche con una negative eigenvalue inserite in un vincolo convesso e` facile e  da` un metodo, di cui sarebbe bene ritrovare il primo caso in cui viene menzionato, oppure darne una breve dimostrazione... io non ne ero a conoscenza (e nemmeno mi viene in mente sui due piedi come dimostrarlo).} 
}

\item Page 17. Doesn't CPLEX support some binary non-convex quadratic
problems.

\rep{We wrote an email to the development team of Cplex and they confirmed that their solver is able to tackle QGL and CGC 
% TODO:Fabio and Emiliano
%\leo{rispondiamo al referee che CPLEX e` classificato 'C' (complete) in tavola 2 rispetto a QGC e ricordiamogli che pero` CPLEX non risolve (a mia conoscenza e per il momento) QGQ. Tra l'altro, c'e` a p. 17 una menzione di "Table 2 below", tranne che la table 2 appare above. Diciamo solo "Table 2" senza il below e l'above, dato che la posizione di tavole e figure puo` comunque essere modificata sia da LaTeX sia dal typesetting finale.} 
}

\item Page 19. I think it would be interesting to give a bit more details about the conic constraints and relate it with the issue of what is a convex
constraint I discuss in point 2. I think the argument is that problems with
non-convex quadratic constraints (i.e. $f (x) \le 0$ with $f$ non-convex) may
have a convex feasible region. I imagine that detecting this in general may
be NP-hard even though the conic case (1 negative eigenvalue) is relatively
easy (e.g. if the problem includes an inequality of the form $a \cdot x \ge$ where
a is the eigenvector associated to the negative eigenvalue). It would then
be interesting to mark the problems with non-convex constraints, but for
which it is known how to show the convexity of the complete feasible
region (because they are conic or another ad-hoc reason).

\rep{We thank the referee for bringing up this point. We addressed it in two comments in Sections 2.2.1 and 2.2.2. 
%TODO: Leo
% \leo{sono d'accordo col referee (ovvero: massi`, facciamolo contento)} \fabio{va qui? o e' un commento al punto di sotto?}
 }


\item Page 20. ``second similar instance filter''. It would be interesting to provide a reference to the similar instances that were filtered out in case
someone wants to test on them. For that matter I am not sure I saw if
the instances have a link/reference to their source.


\rep{The beta version of the library, which containt some of the filtered instances is available online at  \url{http://www.lamsade.dauphine.fr/QPlib2014}. We added this link to the qplib webpage.}



\item Page 36. I am not sure if the reasoning for the name of the instances was mentioned. Is the non-consecutive order because of the filtering? (e.g.
was there a ``0017'' instance that was excluded?)

\rep{Yes. The numbering is due to the filtering. We added a comment on this point in the Appendix of the paper.}


\end{enumerate}
}



\subsection*{Point-by-point reply to the Referee 2}


{\it
The paper presents a library of quadratic programming (QP) instances, where QP is broadly interpreted
to include quadratically constrained, and integer programs too. While I appreciate the overall goal of
the project, the paper is poorly written. It is often long-winded, and contains numerous factual errors,
and some omissions that must be corrected. Overall, the paper can easily be cut by 5-10 pages.
}

\rep{We followed the suggestion of the referee ad the AI and we have shortened unnecessary sections of the paper.}

{\it
\begin{enumerate}

\item There are two classes of important missing application domains of QPs in Table 1: (1) trust-region subproblems, and (2) PDE-constrained optimization problems. In fact, there exist a number of PDE-constrained instances in CUTEr, which would be useful additions to the library. The authors should add at least a few such examples. the lack of these problems is worrying, because
it (implicitly) assumes that direct solvers are used, which means that this library is less relevant for matrix-free solvers.

\rep{
Thank you for pointing out the missing categories. As requested, we updated Table 1 with the two required Applications.
We also included PDE-constrained instances in the updated version of the library.
We have deliberately excluded the highly-specialized class of trust-region subproblems, since there are dedicated, very fast solvers for this class. See for example:
\begin{itemize}
\item
Minimizing a quadratic over a sphere. \\
W. W. Hager. 
SIAM Journal on Optimization,12(1):188-208, 2001.
\item
Solving the trust-region subproblem using the Lanczos method. \\
N. I. M. Gould, S. Lucidi, M. Roma, and Ph. L. Toint. 
SIAM Journal on Optimization, 9(2):504-525, 1999.
\item
A semidefinite framework for trust region subproblems with applications to large scale minimization.\\
F Rendl, H Wolkowicz.
Mathematical Programming 77 (1), 273-299
\item
A Subspace Minimization Method for the Trust-Region Step.\\
J. B. Erway and P. E. Gill.
SIAM J. Optim. 20-3 (2010), pp. 1439-1461
\item
Solving the Trust-Region Subproblem By a Generalized Eigenvalue Problem.\\
S. Adachi, S. Iwata, Y. Nakatsukasa and A Takeda.
SIAM Journal on Optimization 27 (1), 269-291
\item
On solving trust-region and other regularised subproblems in optimization.\\
N.I.M. Gould, D.P. Robinson and H.S. Thorne.
Mathematical Programming Computation 2 (1), 21-57
\end{itemize}
%\leo{sono d'accordo, dovremmo aggiungere delle istanze da trust-region subproblem e delle istanze da problemi PDE-constrained. Chiediamo a Gould per le istanze trust-region e a Gould, Mittelmann e Sahinidis per PDE-constrained. Specifichiamo che vorremmo istanze NON gia` in CUTE.} 
}


\item The taxonomy in Section 2.2.1 seems to be unaware of the fact that an indefinite Hessian does not mean that a problem is difficult. For example, saddle-point problems such as

$$ \begin{bmatrix}
G & A^T\\
A & 0
\end{bmatrix}
\begin{pmatrix}
x \\
z 
\end{pmatrix}
=
\begin{pmatrix}
-g \\
b 
\end{pmatrix}
$$


can be solved to global optimality as long as the matrix is second-order sufficient. This means
that even some QPs with indefinite Hessians can easily be solved to global optimality.

\rep{Thank you for having raised this point. We addressed in Sections 2.2.1 and 2.2.2.
%TODO:Antonio. 
%lo dicevamo già a p. 10, ma grazie per avercelo ricordato: adesso lo richiamiamo brevemente in §2.2.1 e lo discutiamo in §2.2.2
%
%\leo{cosa vuol dire? Questa condizione si puo` testare in polytime? Sicuramente puo` entrare nel discorso a risposta dei punti 2-4 del referee \#1.} 
}


\item The discussion on p.9 recounts some textbook facts, and is largely superfluous. Delete it.

\rep{
Although all the facts recalled in \S 2.2.2 are in fact well known, we still feel they need to be discussed in this context because they illustrate how the taxonomy (as almost all of them) has some grey areas whereby the same underlying problem can be described by instances that would be classified differently. This is, as the header of the section recalls, strongly tied to the concept of reformulation. One relevant example is the relationship between definiteness of the Hessians and convexity, correctly pointed out by the referee, which is naturally discussed in \S 2.2.2. One of the nontrivial choices in our library is that we made no effort to reformulate the instances (although of course we could have), and inserted them in the library in the very same format they have been provided to us by the original contributors. Section 2.2.2 is crucial in justifying this choice, as it shows that there are several degrees of freedom to move the instances from one class to another. Doing so, however, is typically justified by the fact that this makes one specific solver more efficient in solving them, a bias that we don't want to add. Hence, we have chosen to keep the instances in their ``natural'' format, this being the one in which the original contributor initially wrote them.
%TODO: Antonio.
%\leo{cancelliamo tutto!} 
%As requested, aliminated the discussion from the manuscript
}


\item What do you mean by ``exact solution of the instances'' (p.10, l.-18)? I don't believe we can even
solve $Ax = b$ ``exactly'', except in some special cases. Please clarify this statement.

\rep{We added a comment about this issue in Section 2.1 
%\leo{possiamo inserire qualche nota sui modelli di computazione per i numeri reali, razionali e floating point: (a) real numbers con real RAM model, in pratica tutti i calcoli tra numeri reali sono O(1) (la gran parte del lavoro fatto da Blum, Shub e Smale e` sulla definizione di calcolabilita` e complessita` in questo 'ambiente'); 
%(b) hic sunt leones, non si sa nemmeno se la existential theory of rationals (cioe` risolvere sistemi polinomiali su $\mathbb{Q}$) sia decidibile o no [Pheidas 2000]; 
%(c) quello che la gente fa davvero: approssimare optimality e feasibility a $\epsilon>=0$ dato, nel migliore dei casi si dimostra anche che il tempo di calcolo o numero di iterazioni e` $O(1/poly(\epsilon)) o O(log(1/\epsilon))$.
%} 
}


\item The description of NLP solvers in Section 2.3.2 is at somewhat misleading. For example, KNITRO is also a primal-dual interior-point method, not just a barrier code (in fact primal-dual
methods are preferred). The description of the “active-set” methods is wrong, unless you refer
to the inner method, namely the active-set QP solves. Otherwise, SNOPT and KNITRO are
SQP methods, while CONOPT is a gradient-projection method, and MINOS is an augmented
Lagrangian method. You must correct this section

\rep{The complete description of the solver goes beyond the scope of the paper. For this reason we have streamlined the related Section.
%\leo{correggiamo gli errori e ringraziamo il referee} 
}


\item Some classes of problems in Table 4 do not seem to have many instances. Please create more.

\rep{We followed your suggestion and we gathered several additional instances and we included to the final version of the library (see the reply to the AE for further details).}

\item The y-axis labels are missing on most figures.

\rep{
Added.
%\leo{mettiamo la label al y axis  (duh)} 
}


\item Reword the sentence ``percentage of ``hard'' eigenvalues'', p.23, l.-6. The notion of hard has a
special meaning in trust-region problems. Also, this is not a measure of hardness, as explained
above. Instead, you should consider the number of negative eigenvalues of the reduced Hessian
(wrt equality constraints). Fig. 4 is meaningless, unless you replace the definition of hardness.

\rep{
We renamed ``hard" to ``problematic". However, as explained in \S 2.2.1 and 2.2.2, we refrain from reformulating the instance, and we do not tailor problems to specific solvers (moreover, not all QP solvers would resort to reduced Hessians). In the same vein, our analysis can only be based on the given instance structure.
%TODO: Stefan and Ambros.
% \leo{non so nulla di "hard eigenvalues" nel senso del trust region; chiediamo agli esperti} 
 }


\item Improve Fig.5: (1) What do the colors mean? (2) The plot on the right is not a sparsity pattern
of any Hessian, but at best the upper triangular sparsity pattern.

\rep{Corrected, thanks.}


\item I am concerned that problems are only available in GAMS, and tested on GAMS solvers. It would make the paper stronger if the authors also released AMPL model, for example, or made use of
JuMP.

\rep{
We thank the referee for having raised this delicate point. We definitely agree that formats are an issue.
For this reason we have translated all the instances also into the AMPL format and we have uploaded them on the website.
%\leo{Possiamo spiegare che proporre NOI le istanze in formati multipli darebbe la responsabilita` del traduttore a noi, che invece non vogliamo accettarla. D'altro canto penso che, sebbene sia stata una scelta discussa e effettuata democraticamente, non sia necessariamente la scelta giusta per ogni criterio. Per esempio, se il nostro criterio fosse la visibilita` della QPLIB (il numero di gente che la cita), dovremmo ASSOLUTAMENTE tradurre le istanze nel maggior numero possibile di formati. E se qualcuno ci fara` una correzione in futuro chi se ne frega, ringrazieremo e correggeremo. Francamente, se io fossi il dittatore della QPLIB, sceglierei di tradurre le istanze in quanti piu` formati sia possibile (almeno AMPL e SIF), e poi distribuirle con un warning.} \fabio{Adesso abbiamo anche aggiunto il formato AMPL, secondo me con questo il referee si mette tranquillo!} 
}

\end{enumerate}

}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
