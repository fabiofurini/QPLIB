\section{The file format}\label{sec:format}

\newcommand{\vect}[1]{\left(\begin{array}{c}#1\end{array}\right)}
\newcommand{\mat}[2]{\left(\begin{array}{#1}#2\end{array}\right)}
\newcommand{\arr}[2]{\begin{array}{#1}#2\end{array}}
\newcommand{\mininx}[1]{ {\renewcommand{\arraystretch}{0.8}
                     \begin{array}[t]{c}
                     \mbox{minimize} \vspace*{-1mm} \\
                     \mbox{ $\scriptstyle x \in \smallRe^n #1 $ }
                     \end{array} \;} }
\newcommand{\s}[1]{^{\mbox{\protect\tiny #1}}}
\newcommand{\sfrac}[2]{{\scriptstyle \frac{#1}{#2}}}
\newcommand{\half}{\sfrac{1}{2}}
\newcommand{\smallRe}
     {\mbox{\raisebox{-0.8pt}{\footnotesize I\hskip -1.5pt R\hskip -0.5pt}}}
\newcommand{\tim}[1]{\;\; \mbox{#1} \;\;}
\newcommand{\st}{\mbox{subject to}\;\;}
\newcommand{\lbox}[1]{\parbox[t]{105mm}{#1}\vspace*{1mm}}

Following the notation of Section~\ref{sec:QPbasic}, a generic Quadratic Program (QP) can be written as follows:
%
\begin{align*}	
 \min \;\;
 & x^\top Q^0 x + b^0 x + f \\
 %
 & c^i_l \leq x^\top Q^i x + b^i x \leq c^i_u & i \in \Mcm \\ 
 %
 & l_j \leq x_j \leq u_j & j \in \Mcn  \\
 %
 & x_j \in \mathbb{Z} & j \in \Mcz
\end{align*}

where:

\begin{itemize}
 \item $\Mcn = \{ 1, \ldots, n \}$ is the set of (indices) of variables, and $\Mcm = \{ 1, \ldots, m \}$ is the set of (indices) of constraints;
 %
 \item $x = [x_j]_{j = 1}^n \in \RR^n$ is a finite vector of real variables;
 %
 \item $Q^i$ for $i \in \{ 0 \} \cup \Mcm$ are symmetric $n \times n$ real matrices;
 %
 \item $b^i$, $c^i_l$, $c^i_u$ for $i \in \{ 0 \} \cup \Mcm$ and $f$ are, respectively, real $n$-vectors, real constants, real constants and real constant;
 %
 \item $-\infty \leq l_j \leq u_j \leq \infty$ are the (extended) real upper and lower bounds on each variable $x_j$ for $j \in \Mcn$;
 %
 \item $\Mcm = \Mcq \cup \Mcl$ where $Q^i = 0$ for all $i \in \Mcl$;
 %
 \item the variables in $\Mcz \subseteq \Mcm$ are restricted to only attain integer values.
\end{itemize}

%Accordingly, the QPLIB format is designed to cope with a variety of linear and quadratic programs. 
%We distinguish, in particular,
%linear programs (LP)
%\begin{align*}
% \mininx{} & l^T x + f \\
% \st & c\s{L} \leq A x \leq c\s{U} \tim{and} x\s{L} \leq x \leq x\s{U}, \\
%\intertext{linear programs with quadratic constraints (LPQC)}
% \mininx{} & l^T x + f \\
% \st & c\s{L} \leq A x + \half  [x,Q\s{C},x] \leq c\s{U}
%     \tim{and} x\s{L} \leq x \leq x\s{U}, \\
%\intertext{bound-constrained quadratic programs (BQP)}
% \mininx{} & \half x^T Q x + l^T x + f \\
% \st & x\s{L} \leq x \leq x\s{U}, \\
%\intertext{quadratic programs (QP)}
% \mininx{} & \half x^T Q x + l^T x + f \\
% \st & c\s{L} \leq A x \leq c\s{U} \tim{and} x\s{L} \leq x \leq x\s{U}, \\
%\intertext{and quadratic program with quadratic constraints (QPQC)}
% \mininx{} & \half x^T Q x + l^T x + f \\
% \st & c\s{L} \leq A x + \half [x,Q\s{C},x] \leq c\s{U}
%     \tim{and} x\s{L} \leq x \leq x\s{U},
%\end{align*}
%\todo[inline]{\small Stefan: Are LPQC and QPQC frequently used abbreviations? If a linear program has quadratic constraints, how can it then still be a linear program? I am more familiar with the abbreviations QCP instead of LPQC and QCQP instead of QPQC. I further think that one could skip QCP and consider them as part of QCQP.}
%where $Q\s{C}$ is the diagonal matrix with blocks $Q\s{C}_k$, $k=1,\ldots,m$,
%$Q$ and the $Q\s{C}_k$ are symmetric $n$ by $n$ Hessian matrices,
%$A$ is a rectangular $m$ by $n$ constraint matrix,
%$l$, $x\s{L}$, $x\s{U}$, $c\s{L}$, $c\s{U}$
%are vectors of appropriate sizes and $f$ is a scalar; the notation
%$[ x, Q\s{C},x]$ denotes the vector whose $k$-th component is
%$x^T Q\s{C}_k x$.
%In addition, all or a subset of the variables $x$ may be required to be
%integer, while further restrictions (such as a variable being binary)
%may be imposed via explicit constraints.

The QPLIB format is defined in Table~\ref{tab-qplib-format}.
The data is in free format (blanks separate values), but must occur in
the order given here. Any blank lines, or lines starting with any of the
characters !, \% or \# are ignored. Each term in the first column of
Table~\ref{tab-qplib-format} denotes a required value. Any strings beyond
those required on a given line will be regarded as comments and ignored.
Real values may either by in decimal or exponential formats; for the latter,
the exponent may be preceded by either the character {\tt D} or {\tt E},
e.g. {\tt 12.56D+2} or {\tt 12.56E+2}.

\vspace*{2mm}

%\vspace*{-10mm}
%{\tiny
%\LTcapwidth=16.17cm
\begin{longtable}{|llr|}
\caption{\label{tab-qplib-format}{The QPLIB file format: refer to the notes
after the table for more details.}}\\
\hline
data & description & note \\
\hline
\endfirsthead
\caption{The QPLIB file format (continued)}\\
\hline
data & description & note \\
\hline
\endhead
\hline
\endfoot
\hline
\endlastfoot
%\begin{tabular}{|llr|}
%\hline
name & problem name (character string) & \\
type & problem type (character string) & [1] \\
\hline
$n$  & number of variables (integer) & \\
$m$  & number of constraints (integer) & [2] \\
\hline
$n^{Q^0}$ & number of nonzeros  (integer) in lower triangle of $Q^0$  & [3] \\
$h$\; $k$\; $Q_{hk}^0$ & \lbox{row and column indices (integers) and value (real)
for each nonzero entry of $Q^0$, if $n^{Q^0} > 0$, one triple on each line} & \\
\hline
$b^0_d$ & default value (real) for entries in $b^0$ & \\
$n^{b^0}$ & number of non-default entries (integer) in $b^0$ & \\
$j$\; $b^0_j$ & \lbox{index (integer) and value (real) for each non-default
term in $b^0$, if $n^{b^0} > 0$, one pair per line} & \\
\hline
$f$ & constant part of the objective function & \\ \hline
$n^{Q^i}$ & number of nonzeros (integer) in lower triangle of
$Q^i$  & [2,4] \\
$i$\; $h$\; $k$\; $Q^{i}_{hk}$
& \lbox{constraint, row and column indices (integers) and value (real) for
 each entry of $Q^{i}$, if $n^{Q^i}$, one quadruple on each line} & \\
\hline
$n^{b}$ & number of nonzeros  (integer) in $b^i$, $i \in \Mcm$                     & [2] \\
$i$\; $j$\; $b^i_{j}$ & \lbox{row and column indices (integers) and value (real)
for each nonzero
entry of $b^i$, if $n^{b} > 0$, one triple on each line} & \\
\hline
$\infty$ & \lbox{value (real) for infinity for constraint or variable
bounds---any bound greater than or equal to this in, absolute value,
is infinite} & \\
\hline
$c_{l,d}$ & default value (real) for entries in $c_{l}$            & [2] \\
$n^{c_{l,d}}$ & number of non-default entries (integer) in $c_{l}$    & [2] \\
$i$\;\ $c^i_{l}$ & \lbox{index (integer) and value (real) for each non-default
term
in $c_{l,d}$, if $n^{c_{l,d}} > 0$, one pair per line}        & [2] \\
\hline
$c_{u,d}$ & default value (real) for entries in $c_{u}$            & [2] \\
$n^{c_{u,d}}$ & number of non-default entries (integer) in $c_{u}$    & [2] \\
$i$\;\ $c^i_{u}$ & \lbox{index (integer) and value (real) for each non-default
term
in $c_{u,d}$, if $n^{c_{u,d}} > 0$, one pair per line}        & \\
\hline
$l_{d}$ & default value (real) for entries in $l$            & \\
$n^{l_{d}}$ & number of non-default entries (integer) in $l$    &  \\
$i$\;\ $l_{i}$ & \lbox{index (integer) and value (real) for each non-default
term
in $l$, if $n^{l_{d}}> 0$, one pair per line}        &  \\
\hline
$u_{d}$ & default value (real) for entries in $u$            & \\
$n^{u_{d}}$ & number of non-default entries (integer) in $u$    &  \\
$i$\;\ $u_{i}$ & \lbox{index (integer) and value (real) for each non-default
term
in $u$, if $n^{u_{d}}> 0$, one pair per line}        &  \\
\hline
$v_d$ & \lbox{default variable type  (integer, 0 for continuous variables,
 1 for integer variables)} & [5] \\
$n^v$ & number of non-default variables (integer)  & [5] \\
$i$\; $v_i$ & \lbox{index  and type (integers) for each non-default
variable type, if  $n^v > 0$, one pair per line} & [5] \\
\hline
$x\s{0}_d$ & \lbox{default value (real) for the components of the starting
point  $x^0$ for the  variables $x$} & \\
$n^{x^0}$ & number of non-default starting entries (integer) in $x$ & \\
$i$\; $x_i^0$ & \lbox{index (integer) and value (real) for each non-default
starting value in $x^0$, if $n^{x^0} > 0$, one pair per line} &  \\
\hline
$y\s{0}_d$ & \lbox{default value (real) for the components of the starting
point $y^0$ for the Lagrange multipliers $y$ for the general
constraints} &  [2] \\
$n^{y^0}$ & number of non-default starting entries  (integer) in $y$ &  [2] \\
$i$\; $y_i^0$ & \lbox{index (integer) and value (real) for each non-default
starting value in $y^0$, if $n^{y^0} > 0$, one pair per line} &  [2] \\
\hline
$z\s{0}_d$ & \lbox{default value (real) for the components of the starting
point $z^0$ for the dual variables $z$ for the simple bound constraints} & \\
$n^{z^0}$ & number of non-default starting entries (integer) in $z$ & \\
$i$\; $z_i^0$ & \lbox{index (integer) and value (real) for each
non-default starting value in $z^0$, if $n^{z^0} > 0$, one pair per line} &  \\
\hline
$n^x_d$ & \lbox{number of non-default names (integer) of variables---default
for variable $i$ is the character string representing the numerical
value $i$} &  \\
$j$\; ${\tt var\_name}_j$ & \lbox{index (integer) and name (character string)
for each non-default variable name, if $n^x_d > 0$,  one pair per line} & \\
\hline
$n^c_d$ & \lbox{number of non-default names (integer) of general
constraints---default for constraint $i$ is the character string representing
the numerical value $i$} &  \\
$i$\; ${\tt cons\_name}_i$ & \lbox{index  (integer) and name (character string) for each
non-default constraint name, if $n^c_d > 0$,  one pair per line} & \\
\hline
\end{longtable}
%}

\todo[inline]{\small Stefan: I would suggest to make it simpler, even though that
would reduce flexibility. Always fix the default value for coefficients to 0
(otherwise, how you parse this? First initialize a n x n matrix with the non-zero
default and then overwrite with the given entries, which may then be zero?)
and have no default bounds for variables. If you then also adapt the suggestion
to use a constraint sense ($\leq$,$\geq$,$=$) and a right-hand-side instead of
a left- and right-hand-side, then there is also no need to specify a value for infinity.
This would leave out ranged constraints - but are they really used? One could
do it like CPLEX and have an extra constraint sense for ranges and an extra
section to specify the range.}


%\end{tabular}

\renewcommand{\descriptionlabel}[1]{\hspace{\labelsep}\texttt{#1}}

\begin{description}
\item [{[1]}]
\todo[inline]{\small Fabio and Emiliano: we think that, if possible, we should follow the classification proposed in Section 2.}


The problem type is represented by a character string as one of the following:
\begin{description}
\item For continuous problems (i.e., all variables are continuous):
\begin{description}[leftmargin=!,labelwidth=\widthof{\ttfamily SMILQPC}]
\item [LP]      a linear program,
\item [LPQC]    a linear program with quadratic constraints,
\item [BQP]     a bound-constrained quadratic program,
\item [QP]      a quadratic program, and
\item [QPQC]    a quadratic program with quadratic constraints.
\end{description}
\item For integer problems (i.e., all variables are integer valued):
\begin{description}[leftmargin=!,labelwidth=\widthof{\ttfamily SMILQPC}]
\item [ILP]     an integer linear program,
\item [ILPQC]   an integer linear program with quadratic constraints,
\item [IBQP]    an integer bound-constrained quadratic program,
\item [IQP]     an integer quadratic program, and
\item [IQPQC]   an integer quadratic program with quadratic constraints.
\end{description}
\item For mixed-integer problems (i.e., there is a mix of continuous and
integer variables):
\begin{description}[leftmargin=!,labelwidth=\widthof{\ttfamily SMILQPC}]
\item [MILP]    a mixed-integer linear program,
\item [MILPQC]  a mixed-integer linear program with quadratic constraints,
\item [MIBQP]   a mixed-integer bound-constrained quadratic program,
\item [MIQP]    a mixed-integer quadratic program, and
\item [MIQPQC]  a mixed-integer quadratic program with quadratic constraints.
\end{description}
\todo[inline]{\small Stefan: I agree that leaving out information on
numerical properties of the matrices and vectors (convexity, etc.) is good here.
Such properties may also depend on tolerances, etc.
As above, I would suggest to eliminate LPQC and rename QPQC into QCP.
Having a string for ``unspecified'' may be nice, too, or one just uses MIQCQP in this case.}
\end{description}


\item [{[2]}]
for bound-constrained QPs, these sections are omitted.
\item [{[3]}]
for linear program with quadratic constraints, this section is omitted.
\item [{[4]}]
for problems without quadratic constraints, this section is omitted.
\item [{[5]}]
for purely-continuous or purely-integer problems, this section is omitted.
\end{description}

As a simple example, consider the mixed-integer QP
\[\arr{l}{\min_{x \in \smallRe^3} x_1^2 + x_2^2 + x_3^2 - x_1 x_2 - x_2 x_3
  - 0.2 x_1  -0.4 x_2 - 0.2 x_3 \\
\st 1 \leq x_1 + x_2, \; 1 \leq x_1 + x_3, \; 0 \leq x_1 \leq 1,
\; 0 \leq x_2 \leq 2, \; \mbox{and binary} \; x_3.}
\]
This may then be represent in QPLIB format as follows:

{\small
\begin{verbatim}
! ---------------
! example problem
! ---------------
MIPBAND   # problem name
MIQP      # problem is a mixed-integer quadratic program
3         # variables
2         # general linear constraints
5         # nonzeros in lower triangle of Q^0
1 1 2.0   5 lines of row & column index & value of nonzeros in lower triangle Q^0
2 1 -1.0  |
2 2 2.0   |
3 2 -1.0  |
3 3 2.0   |
-0.2      default value for entries in b_0
1         # non default entries in b_0
2 -0.4    1 lines of index & value of non-default values in b_0
0.0       value of f
4         # nonzeros in vectors b^i (i =0,...,m)
1 1 1.0   4 lines of row & column index & value of nonzeros in b^i (i =0,...,m)
1 2 1.0   |
2 1 1.0   |
2 3 1.0   |
1.0E+20   infinity
1.0       default value for entries in c_l
0         # non default entries in c_l
1.0E+20   default value for entries in c_u
0         # non default entries in c_u
0.0       default value for entries in l
0         # non default entries in l
1.0       default value for entries in u
1         # non default entries in u
2 2.0     1 line of non-default indices and values in u
0         default variable type is continuous
1         # non default variable types
3 1       variable 3 is integer
1.0       default value for initial values for x
0         # non default entries in x
0.0       default value for initial values for y
0         # non default entries in y
0.0       default value for initial values for z
0         # non default entries in z
0         # non default names for variables
0         # non default names for constraints
\end{verbatim}
}



